<!DOCTYPE html>
<html class="no-js" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/main">
	
	<th:block layout:fragment="customHead">
		<meta charset="UTF-8">
		<title>leaveCategoryManagement</title>
		<th:block th:include="layout/customHead"></th:block>
		<script>
			$(function(){
				// 카테고리 버튼 클릭 이벤트
				$('.leaveCategoryButton').click(function(){
					console.log('카테고리 버튼 테스트 value : '+$(this).attr('value'));
					// leaveCategoryCode 별로 상세 휴가를 조회하기 위해 code 값을 담는 변수 
					let leaveCategoryCode = $(this).attr('value');
					// 동기 요청(get)
					location.href='/leave/leaveCategoryManagement?leaveCategoryCode='+leaveCategoryCode+'';
				});
				// 상세 휴가 버튼 클릭 이벤트
				$('.leaveDetailButton').click(function(){
					console.log('상세 휴가 버튼 테스트 value : '+$(this).attr('value'));
					// 해당 코드별로 휴가 상세 데이터 조회
					let leaveDetailCode = $(this).attr('value');
					// 비동기 요청
					$.ajax({
						url : '/leave/leaveDetail',
						type : 'get',
						data : {
							leaveDetailCode:leaveDetailCode
						},
						success : function(data){
							console.log(data);
							$('.leaveDetailForm')[0].reset();
							// 리턴 값(leaveDetailList.length) 만큼 상세 휴가를 생성하는 반복문 
							// 휴가 이름 설정
					        $('#leaveDetailSort').attr('value', data.leaveDetailSort);
					        // 기본 휴가 일 설정
					        $('#leaveDetailDay').attr('value', data.leaveDetailDay);
					        // 기본 휴가 시간 설정
					        $('#leaveDetailHour').val(data.leaveDetailHour).prop('selected', true);
					        // 최소 휴가 일 설정
					        $('#leaveDetailMinimumDay').attr('value', data.leaveDetailMinimumDay);
					        // 최소 휴가 시간 설정
					        $('#leaveDetailMinimumHour').val(data.leaveDetailMinimumHour).prop('selected', true);
					        // 최대 휴가 일 설정
					        $('#leaveDetailMaximumDay').attr('value', data.leaveDetailMaximumDay);
					        // 최대 휴가 시간 설정
					        $('#leaveDetailMaximumHour').val(data.leaveDetailMaximumHour).prop('selected', true);
					        // 사용 유무 설정
					        if(data.leaveDetailUseOrNot == 'Y'){
					        	$('#leaveDetailUseOrNot').val(data.leaveDetailUseOrNot).prop('checked', true);
					        }else {
					        	$('#leaveDetailUseOrNot').val(data.leaveDetailUseOrNot).prop('checked', false);
					        }
						},
						error : function(error){
							console.log(error);
							//alert('실패 : '+error);
						}
					});
				});
				// 정책 버튼 클릭 이벤트
				$('.leavePolicyButton').click(function(){
					console.log('휴가 정책 버튼 테스트 value : '+$(this).attr('value'));
					// 해당 코드별로 휴가 정책 데이터 조회
					let leavePolicyCode = $(this).attr('value');
					// 비동기 요청
					$.ajax({
						url : '/leave/leavePolicy',
						type : 'get',
						data : {
							leavePolicyCode:leavePolicyCode
						},
						success : function(data){
							console.log(data);
							$('.leaveDetailForm')[0].reset();
							// 리턴 값(leaveDetailList.length) 만큼 상세 휴가를 생성하는 반복문 
							// 휴가 정책 이름 설정
					        $('#leavePolicyTitle').attr('value', data.leavePolicyTitle);
					        // leavePolicyStandard 설정
					        $('#leavePolicyStandard').val(data.leavePolicyStandard).trigger('change');
					        // leavePolicyStartUnit 설정
					        $('#leavePolicyStartUnit').val(data.leavePolicyStartUnit).trigger('change');
					        // leavePolicyStartPoint 설정
					        $('#leavePolicyStartPoint').val(data.leavePolicyStartPoint).prop('selected', true);
							// 휴가 일수 설정
					        $('#leavePolicyDays').attr('value', data.leavePolicyDays);
						},
						error : function(error){
							console.log(error);
							//alert('실패 : '+error);
						}
					});
				});
				// 휴가 정책 설정 - leavePolicyStandard 선택 이벤트
				$('#leavePolicyStandard').change(function(){
					let leavePolicyStandard = $("#leavePolicyStandard option:selected").val();
					console.log(leavePolicyStandard);
					if(leavePolicyStandard == "회계연도"){
						for (var i = 2; i < 51; i++) {
						    $("#leavePolicyStartPoint").append('<option value="'+i+'">'+i+'</option>');
						}
						$("#leavePolicyStartUnit").val("년").prop('checked', true);
						$("#leavePolicyStartUnit").attr("disabled", true);
					}else{
						$("#leavePolicyStartUnit").attr("disabled", false);
					}
				});
				// 휴가 정책 설정 - leavePolicyStartUnit 선택 이벤트
				$('#leavePolicyStartUnit').change(function(){
					$('#leavePolicyStartPoint').empty();
					let leavePolicyStartUnit = $("#leavePolicyStartUnit option:selected").val();
					console.log(leavePolicyStartUnit);
					if(leavePolicyStartUnit == "년"){
						for (var i = 2; i < 51; i++) {
						    $("#leavePolicyStartPoint").append('<option value="'+i+'">'+i+'</option>');
						}
						$("#leavePolicyStartUnit").val("년").prop('checked', true);
					}else if(leavePolicyStartUnit == "개월"){
						for (var i = 2; i < 12; i++) {
						    $("#leavePolicyStartPoint").append('<option value="'+i+'">'+i+'</option>');
						}
						$("#leavePolicyStartUnit").val("개월").prop('checked', true);
					}else {
						for (var i = 1; i < 32; i++) {
						    $("#leavePolicyStartPoint").append('<option value="'+i+'">'+i+'</option>');
						}
						$("#leavePolicyStartUnit").val("일").prop('checked', true);
					}
				});
				// 페이지 로딩 완료 시 클릭 이벤트(임시)
				//$('#leave_category_code_1').trigger('click');
				// 추가 버튼 클릭 시 입력 폼 초기화
				$('#leaveDetailAddButton').click(function(){
					$('.leaveDetailForm')[0].reset();
				});
				$('#leavePolicyAddButton').click(function(){
					$('.leavePolicyForm')[0].reset();
				});
			});
			</script>
	</th:block>
	
	<th:block layout:fragment="customBody">
		<h2>인사관리 - 휴가 종류 관리</h2>	<br/>
		<div>
			<div class="row">
				<div class="col-3">
					<!-- 휴가 카테고리 네비바 -->
					<div class="card">
						<div class="card-header">휴가 종류</div>
						<div class="card-body">
							<ul class="nav flex-column">
								<li class="nav-item" th:each="list : ${leaveCategoryList}">
									<a class="nav-link leaveCategoryButton" href="#" th:text="${list.leaveCategorySort}" th:value="${list.leaveCategoryCode}"></a>
								</li>	
							</ul>
						</div>
					</div>
							
				</div>
				<div class="col-9">
					<!-- 휴가 카테고리 사용 유무 메뉴 -->
					<div class="card">
						<div class="card-header">휴가 종류 정보</div>
						<div class="card-body">
							<div>휴가 종류 사용 유무</div><br>
							<div>휴가 종류는 휴가 이력 관리를 위하여 삭제하지 않고 휴가 종류 사용을 선택 해제하여 더 이상 사용하지 않도록 설정합니다.</div><br>
							<div class="checkbox-fade fade-in-primary">
							    <label>
							        <input type="checkbox" id="leaveCategoryUseOrNotCheckBox" checked="checked">
							        <span class="cr"><i class="cr-icon ik ik-check txt-primary"></i></span>
							        <span>휴가 종류 사용 유무</span>
							    </label>
							</div>
						</div>
					</div>
					<!-- 상세 휴가 정보 메뉴 -->
					<div class="card">
						<div class="card-header">사용 휴가 종류</div>
						<div class="card-body">
							<div>사용 휴가 종류 설정</div><br>
							<div>휴가 종류에 따라 사용할 사용 휴가 종류를 추가 및 수정하실 수 있습니다.</div>
							<div>수정 시 사용 휴가 종류를 선택하시면 상세 설정 팝업에서 기본 휴가일수, 최대 휴가일수, 최소 휴가일수 등을 설정하실 수 있습니다.</div><br>
							<!-- 상세 휴가 추가 팝업-->
							<div>
								<button type="button" id="leaveDetailAddButton" class="btn btn-outline-primary btn-block" data-toggle="modal" data-target="#detailModal" >추가</button>
							</div>
							<!-- 상세 휴가 리스트 출력 -->
							<th:block th:if="${resultMap != null}">
								<div th:each="list : ${resultMap.leaveDetailList}">
									<button class="leaveDetailButton btn btn-outline-info btn-block" data-toggle="modal" data-target="#detailModal" type="button" th:text="${list.leaveDetailSort}" th:value="${list.leaveDetailCode}"></button>
								</div>
							</th:block>
							<br>
							<!-- 상세 휴가 사용 유무 메뉴 -->
							<div class="checkbox-fade fade-in-primary">
							    <label>
							        <input type="checkbox" id="leaveDetailUseOrNotCheckBox" checked="checked">
							        <span class="cr"><i class="cr-icon ik ik-check txt-primary"></i></span>
							        <span>사용하는 사용 휴가 종류만 보기</span>
							    </label>
							</div>
						</div>
					</div>
					<!-- 휴가일수 부여 정책 메뉴 -->
					<div class="card">
						<div class="card-header">휴가일수 부여 정책</div>
						<div class="card-body">
							<div>휴가일수 부여 정책 설정</div><br>
							<div>정책에 따라 휴가일수를 자동으로 부여를 할 수 있습니다.</div>
							<br>
							<!-- 휴가일수 부여 정책 추가 팝업-->
							<button type="button" id="leavePolicyAddButton" class="btn btn-outline-primary btn-block" data-toggle="modal" data-target="#policyModal">추가</button>
							<!-- 휴가일수 부여 정책 리스트 출력 -->
							<th:block th:if="${resultMap != null}">
								<div th:each="list : ${resultMap.leavePolicyList}">
									<button class="leavePolicyButton btn btn-outline-info btn-block" data-toggle="modal" data-target="#policyModal" type="button" th:text="${list.leavePolicyTitle}" th:value="${list.leavePolicyCode}"></button>
								</div>
							</th:block>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- 상세 휴가 설정 팝업 -->
		<div class="modal" id="detailModal">
			<div class="modal-dialog modal-dialog-scrollable modal-dialog modal-lg">
				<div class="modal-content">
				
					<!-- Modal Header -->
					<div class="modal-header">
						<h4 class="modal-title">사용 휴가 종류 내역 설정</h4>
						<button type="button" class="close" data-dismiss="modal">×</button>
					</div>
					
					<!-- Modal body -->
					<div class="modal-body">
						<form class="leaveDetailForm">
							<!-- 첫 번째 카드 영역 시작 - 사용 휴가 종류 이름 -->
							<div class="card">
								<div class="card-header"><h3>사용 휴가 종류 이름</h3></div>
								<div class="card-body">
									<div>사용 휴가 종류의 이름을 설정합니다.</div><br>
									<!-- 휴가 종류 이름 -->
									<div><input type="text" id="leaveDetailSort" class="form-control"></div>
								</div>
							</div>
							<!-- 첫 번째 카드 영역 종료 - 사용 휴가 종류 이름 -->
							
							<!-- 두 번째 카드 영역 시작 - 휴가 종류 사용 유무 -->
							<div class="card">
								<div class="card-header"><h3>휴가 종류 사용 유무</h3></div>
								<div class="card-body">		
									<div>휴가 종류는 휴가 이력 관리를 위하여 삭제되지 않습니다.</div><br>
									<!-- 사용 유무 체크박스 -->
									<div class="checkbox-fade fade-in-primary">
									    <label>
									        <input type="checkbox" id="leaveDetailUseOrNot" checked="checked">
									        <span class="cr"><i class="cr-icon ik ik-check txt-primary"></i></span>
									        <span>휴가 종류 사용 유무</span>
									    </label>
									</div>
								</div>
							</div>
							<!-- 두 번째 카드 영역 종료 - 휴가 종류 사용 유무 -->	
							<!-- 세 번째 카드 영역 시작 - 기본 휴가일수 설정 -->
							<div class="card">
								<div class="card-header"><h3>기본 휴가일수 설정</h3></div>
								<div class="card-body">		
									<div>본 휴가 종류의 기본 휴가일수를 지정할 수 있습니다.</div><br>
									<div class="form-group row">
										<label for="exampleInputUsername2" class="col-sm-1 col-form-label">기본</label>
										<input type="text" id="leaveDetailDay" class="col-sm-1 form-control">
										<label for="exampleInputUsername2" class="col-sm-1 col-form-label">일</label>
										<select class="form-control col-1" id="leaveDetailHour">
											<option value="0">0
											<option value="1">1
											<option value="2">2
											<option value="3">3
											<option value="4">4
											<option value="5">5
											<option value="6">6
											<option value="7">7
										</select>
										<label for="exampleInputUsername2" class="col-sm-3 col-form-label">시간으로 지정</label>
									</div>
								</div>
							</div>
							<!-- 세 번째 카드 영역 종료 - 기본 휴가일수 설정 -->	
							<!-- 네 번째 카드 영역 시작 - 최소 휴가일수 설정 -->
							<div class="card">
								<div class="card-header"><h3>최소 휴가일수 설정</h3></div>
								<div class="card-body">		
									<div>본 휴가 종류의 신청 건당 최소로 신청 가능한 휴가일수를 지정할 수 있습니다.</div><br>
									<div class="form-group row">
										<label for="exampleInputUsername2" class="col-sm-1 col-form-label">최소</label>
										<input type="text" id="leaveDetailMinimumDay" class="col-sm-1 form-control">
										<label for="exampleInputUsername2" class="col-sm-1 col-form-label">일</label>
										<select class="form-control col-1" id="leaveDetailMinimumHour">
											<option value="0">0
											<option value="1">1
											<option value="2">2
											<option value="3">3
											<option value="4">4
											<option value="5">5
											<option value="6">6
											<option value="7">7
										</select>
										<label for="exampleInputUsername2" class="col-sm-3 col-form-label">시간 이상 신청 가능</label>
									</div>
								</div>
							</div>
							<!-- 네 번째 카드 영역 종료 - 최소 휴가일수 설정 -->	
							<!-- 다섯 번째 카드 영역 시작 - 최대 휴가일수 설정 -->
							<div class="card">
								<div class="card-header"><h3>최대 휴가일수 설정</h3></div>
								<div class="card-body">		
									<div>본 휴가 종류의 신청 건당 최대로 신청 가능한 휴가일수를 지정할 수 있습니다.</div><br>
									<div class="form-group row">
										<label for="exampleInputUsername2" class="col-sm-1 col-form-label">최대</label>
										<input type="text" id="leaveDetailMaximumDay" class="col-sm-1 form-control"> 
										<label for="exampleInputUsername2" class="col-sm-1 col-form-label">일</label>
										<select class="form-control col-1" id="leaveDetailMaximumHour">
											<option value="0">0
											<option value="1">1
											<option value="2">2
											<option value="3">3
											<option value="4">4
											<option value="5">5
											<option value="6">6
											<option value="7">7
										</select> 
										<label for="exampleInputUsername2" class="col-sm-3 col-form-label">시간 이하 신청 가능</label>
									</div>
								</div>
							</div>
							<!-- 다섯 번째 카드 영역 종료 - 최대 휴가일수 설정 -->	
						</form>
					</div>
					<!-- Modal footer -->
					<div class="modal-footer">
						<button type="button" class="btn btn-primary">확인</button>
						<button type="button" class="btn btn-light" data-dismiss="modal">취소</button>
					</div>
				</div>
			</div>
		</div>
		<!-- 휴가 정책 설정 팝업 -->
		<div class="modal" id="policyModal">
			<div class="modal-dialog modal-dialog-scrollable modal-dialog modal-lg">
				<div class="modal-content">
					<!-- Modal Header -->
			        <div class="modal-header">
						<h4 class="modal-title">휴가일수 부여 정책</h4>
						<button type="button" class="close" data-dismiss="modal">×</button>
					</div>
					<!-- Modal body -->
					<div class="modal-body">
						<form class="leavePolicyForm">
							<!-- 첫 번째 카드 영역 시작 - 휴가 정책 이름 -->
							<div class="card">
								<div class="card-header"><h3>1. 휴가일수 부여 정책 이름 정의</h3></div>
								<div class="card-body">
									<div>휴가 부여 정책의 이름을 정의합니다.</div><br>
									<!-- 휴가 정책 이름 -->
									<div><input type="text" id="leavePolicyTitle" class="form-control"></div>
								</div>
							</div>
							<!-- 첫 번째 카드 영역 종료 - 휴가 정책 이름 -->
							<!-- 두 번째 카드 영역 시작 - 휴가 정책 기준 -->
							<div class="card">
								<div class="card-header"><h3>2. 휴가일수 부여 정책 기준 정의</h3></div>
								<div class="card-body">
									<div>휴가일수 부여가 실행될 기준을 정의합니다.</div><br>
									<div class="form-group row">
										<select class="form-control col-2" id="leavePolicyStandard">
											<option value="입사일">입사일
											<option value="회계연도">회계연도
										</select>
										<label for="exampleInputUsername2" class="col-2 col-form-label">로부터</label>
										<select class="form-control col-1" id="leavePolicyStartPoint">
											<option value="">선택
										</select> 
										<select class="form-control col-1" id="leavePolicyStartUnit">
											<option value="년">년
											<option value="개월">개월
											<option value="일">일
										</select>
										<label for="exampleInputUsername2" class="col-sm-5 col-form-label">이 시작되는 날, 해당 임직원에게</label>
									</div>
									<br>
									<div class="form-group row">
										<label for="exampleInputUsername2" class="col-sm-2 col-form-label">연차 유급 휴가</label>
										<input type="text" id="leavePolicyDays" class="col-sm-1 form-control"> 
										<label for="exampleInputUsername2" class="col-sm-2 col-form-label">일 부여</label> 
									</div>
								</div>
							</div>
							<!-- 두 번째 카드 영역 종료 - 휴가 정책 기준 -->
						</form>
					</div>
			        <!-- Modal footer -->
			        <div class="modal-footer">
			          <button type="button" class="btn btn-primary">확인</button>
			          <button type="button" class="btn btn-light" data-dismiss="modal">취소</button>
			        </div>
				</div>
			</div>
		</div>
	</th:block>
	
	<th:block layout:fragment="customJquery">
		<th:block th:include="layout/customJquery"></th:block>
	</th:block>
	
</html>
