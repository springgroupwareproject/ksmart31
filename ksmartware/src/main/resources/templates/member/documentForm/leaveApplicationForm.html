<!DOCTYPE html>
<html class="no-js" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/main">
	
	<th:block layout:fragment="customHead">
		<meta charset="UTF-8">
		<title>휴가신청서</title>
		<th:block th:include="layout/customHead"></th:block>
		<script>
			$(function() {
				// 양식폼이 로드되면 draft_document테이블에 임시저장 상태로 문서 등록
				$.ajax({
					
				});
				
				// 결재선 목록
				$('#approvalProcessLine').click(function() {
					console.log('#approvalProcessLine click!!');
					$.ajax({
						url:'/member/getApprovalProcess'
						, type:'POST'
						, data : {}
			            , success:function(data) {
			            	console.log('비동기 요청 성공');
			            	console.log('결재선');
			            	console.log(data);
			            	$('#approvalProcessList').empty();
			            	// 요청 성공시 결재선목록 뿌려주기
			                $(data).each(function(i,item){
			                    $('#approvalProcessList').append('<option value="'+item.approvalProcessCode+'">'+item.approvalProcessName+'</option>');
			        	   	});
			            }
					});
				});
				
				// 의견 등록
				$('#insertOpinion').click(function() {
					console.log('#insertOpinion click!!');
					
					var insertOpinionBox = $('#insertOpinionBox').val();
					
					if(insertOpinionBox.length == 0) {
						$('#helper').text('내용을 입력하세요.').hide(3000);
					}else {
						$.ajax({
							url:'/member/addApprovalOpinion'
							, type:'POST'
							, data : {'approvalOpinionDesc':approvalOpinionDesc}
							, success : function() {
								console.log('의견 등록 성공');
								$('#opinion').trigger('click');
							} 
						});
					}
				})
				
				// 의견 목록
				$('#opinion').click(function() {
					console.log('#opinion click!!');
					$.ajax({
						url:'/member/approvalOpinionList'
						, type:'GET'
						, data : {}
			            , success:function(data) {
			            	console.log('비동기 요청 성공');
			            	console.log('의견');
			            	console.log(data);
			            	$('#approvalOpinionList').empty();
			            	// 요청 성공시 의견 목록 뿌려주기
			            	$(data).each(function(i,item){
			            		if($('#approvalOpinionList') != null) {
				                    $('#approvalOpinionList').append('<tr>');
				                    $('#approvalOpinionList').append('<td>'+item.memberName+'</td>');
				                    $('#approvalOpinionList').append('<td>'+item.approvalOpinionDesc+'</td>');
				                    $('#approvalOpinionList').append('<td>'+item.approvalOpinionDate+'</td>');
				                    $('#approvalOpinionList').append('</tr>');
			            		}else {
				                    $('#approvalOpinionList').append('<tr>');
				                    $('#approvalOpinionList').append('<td>의견이 없습니다.</td>');
				                    $('#approvalOpinionList').append('</tr>');
			            		}
			        	   	});
			            }
					});
				});
				
				// 첨부파일 목록
				$('#file').click(function() {
					console.log('#file click!!');
					$.ajax({
						url:'/member/approvalFileList'
						, type:'GET'
						, data : {}
			            , success:function(data) {
			            	console.log('비동기 요청 성공');
			            	console.log('파일');
			            	console.log(data);
			            	$('#approvalFileList').empty();
			            	// 요청 성공시 의견 목록 뿌려주기
			            	$(data).each(function(i,item){
			            		if($('#approvalFileList') != null) {
				                    $('#approvalFileList').append('<tr>');
				                    $('#approvalFileList').append('<td>'+item.approvalFileSaveName+'</td>');
				                    $('#approvalFileList').append('<td>'+item.approvalFileExt+'</td>');
				                    $('#approvalFileList').append('</tr>');
			            		}else {
			            			$('#approvalFileList').append('<tr>');
				                    $('#approvalFileList').append('<td>파일이 없습니다.</td>');
				                    $('#approvalFileList').append('</tr>');
			            		}
			        	   	});
			            }
					});
				})
			});
		</script>
	</th:block>
	
	<th:block layout:fragment="customBody">
		<div class="row">
			<!-- 왼쪽 칸 시작 -->
			<div class="col-md-8">
				<div class="card" style="min-height: 484px;">
			        <div class="card-header"><h3>휴가신청서</h3></div>
		            <div class="card-body">
		                <form class="forms-sample">
			                <!-- 첫번째 테이블 시작 -->
		                	<div class="form-group row">
		                        <label for="departmentName" class="col-sm-3 col-form-label">부서</label>
		                        <div class="col-sm-9">
		                            <input type="text" class="form-control" id="departmentName" th:value="${loginMember.departmentName}">
		                        </div>
		                    </div>
		                    <div class="form-group row">
		                        <label for="memberPositionName" class="col-sm-3 col-form-label">직위/직책</label>
		                        <div class="col-sm-9">
		                            <input type="text" class="form-control" id="memberPositionName" th:value="${loginMember.memberPositionName}">
		                        </div>
		                    </div>
		                    <div class="form-group row">
		                        <label for="memberName" class="col-sm-3 col-form-label">신청자명</label>
		                        <div class="col-sm-9">
		                            <input type="text" class="form-control" id="memberName" th:value="${loginMember.memberName}">
		                        </div>
		                    </div>
		                    <div class="form-group row">
		                        <label for="draftDocumentDate" class="col-sm-3 col-form-label">기안일</label>
		                        <div class="col-sm-9">
		                            <input type="text" class="form-control" id="draftDocumentDate">
		                        </div>
		                    </div>
		                    <div class="form-group row">
		                        <label for="exampleInputMobile" class="col-sm-3 col-form-label">휴가일수 합계</label>
		                        <div class="col-sm-9">
		                            <input type="text" class="form-control" id="exampleInputMobile" placeholder="">
		                        </div>
		                    </div>
		                    <!-- 첫번째 테이블 끝 -->
        
						    <!-- 두 번째 테이블 시작-->
						    <div class="form-control form-txt-inverse" style="padding:10px;">
			    				<div class="form-group row">
			                        <label for="draftDocumentDate" class="col-sm-3 col-form-label">휴가종류</label>
			                        <div class="col-sm-5">
					                     <select class="form-control" id="exampleSelectGender">
		                                     <option>선택하세요</option>
											 <option>오전 반차 휴가</option>
											 <option>오후 반차 휴가</option>
											 <option>연차 휴가</option>
											 <option>월차 휴가</option>
											 <option>대체 휴가</option>
											 <option>재량 휴가</option>
											 <option>장기 근속 휴가</option>
											 <option>본인 결혼</option>
											 <option>자녀 결혼</option>
											 <option>본인 및 배우자 출산</option>
											 <option>본인 및 배우자 부모의 사망</option>
											 <option>본인 및 배우자의 조부모 및 외조부모 사망</option>
											 <option>본인의 자녀 및 그 자녀의 배우자 사망</option>
											 <option>본인 및 배우자의 형제자매 사망</option>
											 <option>생리 휴가</option>
											 <option>출산전후휴가</option>
											 <option>일반 병가</option>
											 <option>공무상 병가</option>
											 <option>공무상 휴가</option>
		                                 </select>
			                        </div>
			                    </div>
			     				<div class="form-group row">
			                        <label for="leaveDays" class="col-sm-3 col-form-label">휴가기간</label>
			                        <div class="col-sm-5">
					                	<input type="text" class="form-control" id="leaveDays" placeholder="yyyy-MM-dd">
			                        </div>
			                    </div>
			                    <div class="form-group row">
			                        <label for="leaveApplicationDays" class="col-sm-3 col-form-label">휴가일수</label>
			                        <div class="row col-sm-5">
		                             	<div class="col-sm-12">
		                          			<div class="input-group">
		                          				<input type="email" class="form-control" id="leaveApplicationDays" placeholder="휴가일수"><span style="margin: 10px 0px 0px 0px">&nbsp 일 &nbsp</span>
			                          			<select class="form-control" id="leaveApplicationDays">
			                                  		<option>0</option>
			                                  		<option>1</option>
			                                  		<option>2</option>
			                                  		<option>3</option>
			                                  		<option>4</option>
			                                  		<option>5</option>
			                                  		<option>6</option>
			                                  		<option>7</option>
			                             		</select>
			                             		<span style="margin: 10px 0px 0px 0px">&nbsp 시간</span>
		                             		</div>
		                             	</div>
			                    	</div>
			                    </div>
			    				<div class="form-group row">
			                        <label for="draftDocumentDate" class="col-sm-3 col-form-label">휴가사유</label>
			                        <div class="col-sm-5">
					                	<textarea class="form-control" id="leaveApplicationReason" rows="4"></textarea>
			                        </div>
				                </div>
				    		</div>
				    		<!-- 두번째 테이블 끝 -->
				        </form>
				    </div>
				</div>
			</div>
			<!-- 왼쪽 칸 끝 -->
			
			<!-- 오른쪽 칸 시작-->
			<div class="col-4">
				<div class="card" style="min-height: 484px;">
<!-- 					<div class="card-header">
					<label class="btn btn-primary">기안하기</label>
					<label class="btn btn-outline-primary">임시저장</label>
						<button type="submit" class="btn btn-primary mr-2">기안</button>
				        <button class="btn btn-light">임시저장</button>
					</div> -->
					<div class="card-body">
						<ul class="nav nav-tabs">
						  <li class="nav-item">
						    <a class="nav-link active" id="approvalProcessLine" data-toggle="tab" href="#approvalProcess">결재선 설정</a>
						  </li>
						  <li class="nav-item">
						    <a class="nav-link" id="opinion" data-toggle="tab" href="#opinionList">의견</a>
						  </li>
						  <li class="nav-item">
						    <a class="nav-link" id="file" data-toggle="tab" href="#fileList">첨부파일</a>
						  </li>
						</ul>
						<br>
						<div class="tab-content">
							<!-- 결재선 설정 탭 -->
							<div class="tab-pane fade show active" id="approvalProcess">
							     <form class="sample-form">
							          <div class="form-group">
							               <select class="form-control select2" id="approvalProcessList">
										   </select>
							          </div>
							     </form>
							</div>
							<!-- 의견 탭 -->
							<div class="tab-pane fade" id="opinionList">
								<div class="card-block">
									<div class="table-responsive">
										<table style="width:100%">
											<tbody id="approvalOpinionList">
									        </tbody>
										</table>
									</div>
								</div>
								<div class="row">
						  			<textarea class="form-control" id="insertOpinionBox" rows="4" placeholder="의견을 등록해주세요."></textarea>
						  			<button id="insertOpinion" type="button" class="btn btn-primary mr-2">등록</button>
						  			<span id="helper"></span>
						  		</div>
							</div>
							<!-- 첨부파일 탭 -->
							<div class="tab-pane fade" id="fileList">
								<div class="card-block">
									<div class="table-responsive">
										<table style="width:100%">
											<tbody id="approvalFileList">
									        </tbody>
										</table>
										<button type="button" class="btn btn-outline-secondary btn-rounded"><i class="ik ik-share"></i>Upload</button>
									</div>
								</div>
							</div>
						</div>
		            </div>
		            <div class="modal-footer">
                        <button type="button" class="btn btn-primary">기안하기</button>
                        <button type="button" class="btn btn-secondary">임시저장</button>
                    </div>
				</div>
			</div>
			<!-- 오른쪽 칸 끝-->
		</div>
	</th:block>
	
	<th:block layout:fragment="customJquery">
		<th:block th:include="layout/customJquery"></th:block>
	</th:block>
	
</html>